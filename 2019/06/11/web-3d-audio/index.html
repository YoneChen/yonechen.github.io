<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.2" rel="stylesheet" type="text/css">


  <meta name="keywords" content="webAudio,">








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.2">






<meta name="description" content="åœ¨3då¼€å‘ä¸­ï¼Œé™¤äº†å›¾å½¢è§†è§‰æ¸²æŸ“ï¼ŒéŸ³é¢‘å¤„ç†æ˜¯é‡è¦çš„ä¸€ç¯ï¼Œå¥½çš„éŸ³é¢‘å¤„ç†å¯ä»¥æ¬ºéª—ç”¨æˆ·çš„å¬è§‰ï¼Œè¾¾åˆ°èº«ä¸´å…¶å¢ƒçš„æ•ˆæœï¼Œæœ¬æ–‡ä¸»è¦ä»‹ç»Web3Dä¸­æ²‰æµ¸å¼éŸ³é¢‘çš„å®ç°ã€‚ 3D Audio3dæ²‰æµ¸å¼åœºæ™¯éŸ³é¢‘çš„è¾“å‡ºç¡¬ä»¶ä¸»è¦æ˜¯è€³æœºï¼Œæ ¹æ®éŸ³é¢‘æºä¸åœºæ™¯ä¹‹é—´çš„å…³ç³»ï¼Œå¯å°†3déŸ³é¢‘åˆ†ä¸ºä¸¤ç±»ï¼šé™æ€éŸ³é¢‘å’Œç©ºé—´åŒ–éŸ³é¢‘(audio spatialization)ã€‚ é™æ€éŸ³é¢‘è¿™ç±»éŸ³é¢‘ä½œç”¨äºæ•´ä¸ª3dåœºæ™¯ï¼Œå¯ç®€å•çš„ç†è§£æˆèƒŒæ™¯éŸ³ä¹ï¼ŒéŸ³é¢‘è¾“å‡ºæ˜¯é™æ€">
<meta name="keywords" content="webAudio">
<meta property="og:type" content="article">
<meta property="og:title" content="Web Audioå®ç°3DéŸ³æ•ˆ">
<meta property="og:url" content="https://www.yonechen.com/2019/06/11/web-3d-audio/index.html">
<meta property="og:site_name" content="Yone Chen">
<meta property="og:description" content="åœ¨3då¼€å‘ä¸­ï¼Œé™¤äº†å›¾å½¢è§†è§‰æ¸²æŸ“ï¼ŒéŸ³é¢‘å¤„ç†æ˜¯é‡è¦çš„ä¸€ç¯ï¼Œå¥½çš„éŸ³é¢‘å¤„ç†å¯ä»¥æ¬ºéª—ç”¨æˆ·çš„å¬è§‰ï¼Œè¾¾åˆ°èº«ä¸´å…¶å¢ƒçš„æ•ˆæœï¼Œæœ¬æ–‡ä¸»è¦ä»‹ç»Web3Dä¸­æ²‰æµ¸å¼éŸ³é¢‘çš„å®ç°ã€‚ 3D Audio3dæ²‰æµ¸å¼åœºæ™¯éŸ³é¢‘çš„è¾“å‡ºç¡¬ä»¶ä¸»è¦æ˜¯è€³æœºï¼Œæ ¹æ®éŸ³é¢‘æºä¸åœºæ™¯ä¹‹é—´çš„å…³ç³»ï¼Œå¯å°†3déŸ³é¢‘åˆ†ä¸ºä¸¤ç±»ï¼šé™æ€éŸ³é¢‘å’Œç©ºé—´åŒ–éŸ³é¢‘(audio spatialization)ã€‚ é™æ€éŸ³é¢‘è¿™ç±»éŸ³é¢‘ä½œç”¨äºæ•´ä¸ª3dåœºæ™¯ï¼Œå¯ç®€å•çš„ç†è§£æˆèƒŒæ™¯éŸ³ä¹ï¼ŒéŸ³é¢‘è¾“å‡ºæ˜¯é™æ€">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/1939855-942d158693596285.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/1939855-fd028f7d954fc1ba.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/1939855-fd8d789678835186.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/1939855-a2e551ff0d5b4bb6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/1939855-a0b7fe84246097c3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:updated_time" content="2019-06-11T03:36:21.008Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Web Audioå®ç°3DéŸ³æ•ˆ">
<meta name="twitter:description" content="åœ¨3då¼€å‘ä¸­ï¼Œé™¤äº†å›¾å½¢è§†è§‰æ¸²æŸ“ï¼ŒéŸ³é¢‘å¤„ç†æ˜¯é‡è¦çš„ä¸€ç¯ï¼Œå¥½çš„éŸ³é¢‘å¤„ç†å¯ä»¥æ¬ºéª—ç”¨æˆ·çš„å¬è§‰ï¼Œè¾¾åˆ°èº«ä¸´å…¶å¢ƒçš„æ•ˆæœï¼Œæœ¬æ–‡ä¸»è¦ä»‹ç»Web3Dä¸­æ²‰æµ¸å¼éŸ³é¢‘çš„å®ç°ã€‚ 3D Audio3dæ²‰æµ¸å¼åœºæ™¯éŸ³é¢‘çš„è¾“å‡ºç¡¬ä»¶ä¸»è¦æ˜¯è€³æœºï¼Œæ ¹æ®éŸ³é¢‘æºä¸åœºæ™¯ä¹‹é—´çš„å…³ç³»ï¼Œå¯å°†3déŸ³é¢‘åˆ†ä¸ºä¸¤ç±»ï¼šé™æ€éŸ³é¢‘å’Œç©ºé—´åŒ–éŸ³é¢‘(audio spatialization)ã€‚ é™æ€éŸ³é¢‘è¿™ç±»éŸ³é¢‘ä½œç”¨äºæ•´ä¸ª3dåœºæ™¯ï¼Œå¯ç®€å•çš„ç†è§£æˆèƒŒæ™¯éŸ³ä¹ï¼ŒéŸ³é¢‘è¾“å‡ºæ˜¯é™æ€">
<meta name="twitter:image" content="http://upload-images.jianshu.io/upload_images/1939855-942d158693596285.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.2',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn"}},
    duoshuo: {
      userId: '0',
      author: 'åšä¸»'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://www.yonechen.com/2019/06/11/web-3d-audio/">





  <title>Web Audioå®ç°3DéŸ³æ•ˆ | Yone Chen</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Yone Chen</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            é¦–é¡µ
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            å…³äº
          </a>
        </li>
      
        
        <li class="menu-item menu-item-cases">
          <a href="/cases/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-calendar"></i> <br>
            
            cases
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            å½’æ¡£
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://www.yonechen.com/2019/06/11/web-3d-audio/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Yone Chen">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yone Chen">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Web Audioå®ç°3DéŸ³æ•ˆ</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2019-06-11T11:33:32+08:00">
                2019-06-11
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p><img src="http://upload-images.jianshu.io/upload_images/1939855-942d158693596285.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>åœ¨3då¼€å‘ä¸­ï¼Œé™¤äº†å›¾å½¢è§†è§‰æ¸²æŸ“ï¼ŒéŸ³é¢‘å¤„ç†æ˜¯é‡è¦çš„ä¸€ç¯ï¼Œå¥½çš„éŸ³é¢‘å¤„ç†å¯ä»¥æ¬ºéª—ç”¨æˆ·çš„å¬è§‰ï¼Œè¾¾åˆ°èº«ä¸´å…¶å¢ƒçš„æ•ˆæœï¼Œæœ¬æ–‡ä¸»è¦ä»‹ç»Web3Dä¸­æ²‰æµ¸å¼éŸ³é¢‘çš„å®ç°ã€‚</p>
<h1 id="3D-Audio"><a href="#3D-Audio" class="headerlink" title="3D Audio"></a>3D Audio</h1><p>3dæ²‰æµ¸å¼åœºæ™¯éŸ³é¢‘çš„è¾“å‡ºç¡¬ä»¶ä¸»è¦æ˜¯è€³æœºï¼Œæ ¹æ®éŸ³é¢‘æºä¸åœºæ™¯ä¹‹é—´çš„å…³ç³»ï¼Œå¯å°†3déŸ³é¢‘åˆ†ä¸ºä¸¤ç±»ï¼šé™æ€éŸ³é¢‘å’Œç©ºé—´åŒ–éŸ³é¢‘(audio spatialization)ã€‚</p>
<h2 id="é™æ€éŸ³é¢‘"><a href="#é™æ€éŸ³é¢‘" class="headerlink" title="é™æ€éŸ³é¢‘"></a>é™æ€éŸ³é¢‘</h2><p>è¿™ç±»éŸ³é¢‘ä½œç”¨äºæ•´ä¸ª3dåœºæ™¯ï¼Œå¯ç®€å•çš„ç†è§£æˆèƒŒæ™¯éŸ³ä¹ï¼ŒéŸ³é¢‘è¾“å‡ºæ˜¯é™æ€çš„ï¼Œæ¯”å¦‚å¾®é£é›¨æ»´å£°ã€é—¹å¸‚å£°ç­‰å……æ–¥æ•´ä¸ªåœºæ™¯çš„èƒŒæ™¯éŸ³æ•ˆã€‚<br>å¯¹äºç¯å¢ƒéŸ³æ•ˆçš„å¼€å‘ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•çš„ä½¿ç”¨<audio>æ ‡ç­¾è¿›è¡Œå¾ªç¯æ’­æ”¾ã€‚</audio></p>
<h2 id="ç©ºé—´åŒ–éŸ³é¢‘"><a href="#ç©ºé—´åŒ–éŸ³é¢‘" class="headerlink" title="ç©ºé—´åŒ–éŸ³é¢‘"></a>ç©ºé—´åŒ–éŸ³é¢‘</h2><p>éŸ³é¢‘ä½œç”¨åœ¨ç©ºé—´çš„å®ä½“ä¸Šï¼Œå…·æœ‰å‘å£°ä½“å’Œå¬è€…çš„ä½ç½®å…³ç³»ï¼ŒéŸ³é¢‘è¾“å‡ºä¼šæ ¹æ®å‘å£°ä½“ä¸ç”¨æˆ·çš„è·ç¦»ã€æ–¹å‘åŠ¨æ€å˜åŒ–ï¼Œå®ƒæ¨¡æ‹Ÿäº†ç°å®ä¸­å£°éŸ³çš„ä¼ æ’­æ–¹å¼ï¼Œå…·æœ‰ç©ºé—´æ„Ÿã€‚</p>
<p>å®ç°åŸç†ï¼šåœ¨è™šæ‹Ÿåœºæ™¯ä¸­ï¼Œé€šè¿‡è°ƒèŠ‚éŸ³é¢‘çš„æŒ¯å¹…æ¥æè¿°å‘å£°ä½“ä¸å¬è€…ä¹‹é—´çš„è·ç¦»ï¼Œå†é€šè¿‡è°ƒèŠ‚å·¦å³é€šé“(audio channel)ä¹‹é—´çš„å·®å¼‚ï¼Œæ§åˆ¶å·¦å³è€³æœºå–‡å­è¾“å‡ºï¼Œæ¥æè¿°å‘å£°ä½“ç›¸å¯¹å¬è€…çš„æ–¹ä½ã€‚</p>
<ul>
<li>ä»å‘å£°ä½“ä¸ç”¨æˆ·ä¸¤ç‚¹é—´çš„è·ç¦»æ¥çœ‹ï¼Œå¦‚è·ç¦»è¶Šè¿œï¼ŒéŸ³é¢‘éŸ³é‡ï¼ˆæŒ¯å¹…ï¼‰åº”è¶Šå°ï¼›</li>
<li>ä»å‘å£°ä½“ä¸ç”¨æˆ·çš„æ–¹å‘æ¥çœ‹ï¼Œå¦‚å‘å£°ä½“ä½äºå¬è€…å·¦ä¾§ï¼Œåˆ™éŸ³é¢‘è¾“å‡ºçš„å·¦å£°é“åº”æ¯”å³å£°é“éŸ³é‡å¤§ã€‚<br><img src="http://upload-images.jianshu.io/upload_images/1939855-fd028f7d954fc1ba.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="3Dç«‹ä½“éŸ³æ•ˆåŸç†"></li>
</ul>
<p>å½¢å¦‚éŸ³é¢‘ç©ºé—´åŒ–æ­¤ç±»ç¨å¤æ‚çš„éŸ³é¢‘çš„å¤„ç†ï¼Œå¯é€šè¿‡Web Audio APIæ¥å®ç°ã€‚</p>
<h1 id="Web-Audio-API-ç®€ä»‹"><a href="#Web-Audio-API-ç®€ä»‹" class="headerlink" title="Web Audio API ç®€ä»‹"></a>Web Audio API ç®€ä»‹</h1><p>Web Audio APIæä¾›äº†ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„éŸ³é¢‘å¤„ç†ç³»ç»Ÿï¼Œå…è®¸æˆ‘ä»¬åœ¨æµè§ˆå™¨ä¸­é€šè¿‡jsæ¥å®æ—¶æ§åˆ¶å¤„ç†éŸ³é¢‘ï¼Œæ¯”å¦‚éŸ³é¢‘å¯è§†åŒ–ã€éŸ³é¢‘æ··åˆç­‰ã€‚<br><img src="http://upload-images.jianshu.io/upload_images/1939855-fd8d789678835186.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt></p>
<p>Web Audioå¤„ç†æµç¨‹å¯ä»¥æ¯”å–»æˆä¸€ä¸ªåŠ å·¥å‚å¯¹å£°æºçš„åŠ å·¥ï¼Œè¿™ä¸ªåŠ å·¥å‚ç”±å¤šä¸ªåŠ å·¥æ¨¡å—<code>AudioNode</code>è¿æ¥è€Œæˆï¼ŒéŸ³é¢‘æºç»è¿‡ä¸€ç³»åˆ—çš„å¤„ç†åŠ å·¥åï¼Œè¢«è¾“é€è‡³æ‰¬å£°å™¨ã€‚</p>
<h2 id="AudioContext"><a href="#AudioContext" class="headerlink" title="AudioContext"></a>AudioContext</h2><p>ç±»ä¼¼äº<code>canvas</code>çš„<code>context</code>ä¸Šä¸‹æ–‡ç¯å¢ƒï¼Œå®ƒä»£è¡¨äº†ä¸€ä¸ªaudioåŠ å·¥å‚æ§åˆ¶ä¸­å¿ƒï¼Œè´Ÿè´£å„ä¸ªaudioNodeçš„åˆ›å»ºå’Œç»„åˆï¼Œé€šè¿‡<code>new AudioContext()</code>çš„æ–¹å¼åˆ›å»ºã€‚</p>
<h2 id="AudioNode"><a href="#AudioNode" class="headerlink" title="AudioNode"></a>AudioNode</h2><p>AudioNodeéŸ³é¢‘èŠ‚ç‚¹ï¼Œåˆ™æ˜¯åŠ å·¥å‚çš„åŠ å·¥æ¨¡å—ï¼Œ æŒ‰ç…§åŠŸèƒ½å¯åˆ†ä¸ºä¸‰ç±»ï¼šè¾“å…¥ç»“ç‚¹ã€å¤„ç†ç»“ç‚¹ã€è¾“å‡ºç»“ç‚¹ã€‚æ¯ä¸ªç»“ç‚¹éƒ½æ‹¥æœ‰<code>connect</code>æ–¹æ³•è¿æ¥ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå°†éŸ³é¢‘è¾“å‡ºåˆ°ä¸‹ä¸€ä¸ªæ¨¡å—ã€‚</p>
<ul>
<li>è¾“å…¥ç»“ç‚¹ä¸»è¦è´Ÿè´£åŠ è½½è§£ç éŸ³é¢‘æºï¼Œæ¯”å¦‚è·å–äºŒè¿›åˆ¶éŸ³é¢‘æºçš„<code>BufferSourceNode</code>ã€è·å–<audio>éŸ³é¢‘æºçš„<code>MediaElementSourceNode</code>ç­‰ï¼›</audio></li>
<li>å¤„ç†ç»“ç‚¹ä¸»è¦å¯¹éŸ³é¢‘æ•°æ®è¿›è¡Œè®¡ç®—å¤„ç†ï¼Œæ¯”å¦‚å¤„ç†éŸ³é¢‘æŒ¯å¹…çš„<code>GainNode</code>ç­‰ï¼›</li>
<li>è¾“å‡ºç»“ç‚¹åˆ™å°†éŸ³é¢‘è¾“å‡ºè‡³æ‰¬å£°å™¨æˆ–è€³æœºï¼Œ<code>AudioContext.destination</code>ä¾¿æ˜¯é»˜è®¤çš„è¾“å‡ºèŠ‚ç‚¹ã€‚</li>
</ul>
<p>ä¸€ä¸ªç®€å•çš„éŸ³é¢‘å¤„ç†æµç¨‹åªéœ€è¦åˆ†ä¸ºå››æ­¥ï¼š</p>
<ol>
<li>åˆ›å»ºéŸ³é¢‘ä¸Šä¸‹æ–‡</li>
<li>åˆ›å»ºå¹¶åˆå§‹åŒ–è¾“å…¥ç»“ç‚¹ã€å¤„ç†ç»“ç‚¹</li>
<li>å°†è¾“å…¥ç»“ç‚¹ã€å¤„ç†ç»“ç‚¹ã€è¾“å‡ºç»“ç‚¹è¿›è¡Œæœ‰è¿æ¥</li>
<li>åŠ¨æ€ä¿®æ”¹ç»“ç‚¹å±æ€§ä»¥è¾“å‡ºä¸åŒéŸ³æ•ˆ</li>
</ol>
<p>å‚è€ƒä»¥ä¸‹ä»£ç ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> myAudio = <span class="built_in">document</span>.querySelector(<span class="string">'audio'</span>);</span><br><span class="line"><span class="keyword">const</span> audioCtx = <span class="keyword">new</span> AudioContext(); <span class="comment">// åˆ›å»ºéŸ³é¢‘ä¸Šä¸‹æ–‡</span></span><br><span class="line"> <span class="comment">// åˆ›å»ºè¾“å…¥ç»“ç‚¹ï¼Œè§£ç audioæ ‡ç­¾çš„éŸ³é¢‘æºï¼›åˆ›å»ºå¤„ç†ç»“ç‚¹ï¼Œå¤„ç†éŸ³é¢‘</span></span><br><span class="line"><span class="keyword">const</span> source = audioCtx.createMediaElementSource(myAudio);</span><br><span class="line"><span class="keyword">const</span> gainNode = audioCtx.createGain(); <span class="comment">// åˆ›å»ºGainNodeç»“ç‚¹æ§åˆ¶éŸ³é¢‘æŒ¯å¹…</span></span><br><span class="line"><span class="comment">// å°†è¾“å…¥ç»“ç‚¹ã€å¤„ç†ç»“ç‚¹ã€è¾“å‡ºç»“ç‚¹ä¸¤ä¸¤ç›¸è¿</span></span><br><span class="line">source.connect(gainNode); <span class="comment">// å°†è¾“å…¥ç»“ç‚¹è¿æ¥åˆ°gainNodeå¤„ç†ç»“ç‚¹</span></span><br><span class="line">gainNode.connect(audioCtx.destination); <span class="comment">// å°†gainNodeè¿æ¥åˆ°destinationè¾“å‡ºèŠ‚ç‚¹</span></span><br><span class="line"><span class="comment">// é€šè¿‡åŠ¨æ€æ”¹å˜ç»“ç‚¹å±æ€§äº§ç”Ÿä¸åŒéŸ³æ•ˆ</span></span><br><span class="line">source.start(<span class="number">0</span>); <span class="comment">// æ’­æ”¾éŸ³é¢‘</span></span><br><span class="line">gainNode.gain.value = val; <span class="comment">// è®¾ç½®éŸ³é‡</span></span><br></pre></td></tr></table></figure></p>
<p>ç†è§£äº†Web Audioçš„å¼€å‘æµç¨‹ï¼Œæ¥ä¸‹æ¥çœ‹çœ‹å¦‚ä½•åœ¨Web3dä¸­å®ç°Audio Spatializationï¼Œè¿™é‡Œ3dåœºæ™¯ä½¿ç”¨three.jsè¿›è¡Œå¼€å‘ã€‚</p>
<hr>
<h1 id="å®ç°ç©ºé—´åŒ–éŸ³é¢‘"><a href="#å®ç°ç©ºé—´åŒ–éŸ³é¢‘" class="headerlink" title="å®ç°ç©ºé—´åŒ–éŸ³é¢‘"></a>å®ç°ç©ºé—´åŒ–éŸ³é¢‘</h1><p>Audio Spatializationçš„å®ç°ä¸»è¦é€šè¿‡<code>AudioListener</code>å’Œ<code>PannerNode</code>ç»“ç‚¹é…åˆï¼Œè¿™ä¸¤ä¸ªå¯¹è±¡å¯ä»¥æ ¹æ®ç©ºé—´æ–¹ä½ä¿¡æ¯åŠ¨æ€å¤„ç†éŸ³é¢‘æºï¼Œå¹¶è¾“å‡ºå·¦å³å£°é“ã€‚</p>
<ul>
<li><code>AudioListener</code>å¯¹è±¡ä»£è¡¨ä¸‰ç»´ç©ºé—´ä¸­çš„å¬è€…ï¼ˆç”¨æˆ·ï¼‰ï¼Œé€šè¿‡<code>AudioContext.listener</code>å±æ€§è·å–ï¼›</li>
<li><code>PannerNode</code>å¯¹è±¡æŒ‡çš„æ˜¯ä¸‰ç»´ç©ºé—´ä¸­çš„å‘å£°ä½“ï¼Œé€šè¿‡ <code>AudioContext.createPanner()</code>åˆ›å»ºã€‚<br>æˆ‘ä»¬éœ€è¦åˆå§‹åŒ–è¿™ä¸¤ä¸ªå¯¹è±¡ï¼Œå¹¶å°†ç©ºé—´æ–¹ä½ä¿¡æ¯ä½œä¸ºå…¥å‚åŠ¨æ€ä¼ ç»™å®ƒä»¬ã€‚</li>
</ul>
<h2 id="è®¾ç½®PannerNode"><a href="#è®¾ç½®PannerNode" class="headerlink" title="è®¾ç½®PannerNode"></a>è®¾ç½®PannerNode</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> myAudio = <span class="built_in">document</span>.querySelector(<span class="string">'audio'</span>);</span><br><span class="line"><span class="keyword">const</span> audioCtx = <span class="keyword">new</span> AudioContext(); <span class="comment">// åˆ›å»ºéŸ³é¢‘ä¸Šä¸‹æ–‡</span></span><br><span class="line"><span class="keyword">const</span> source = audioCtx.createMediaElementSource(myAudio);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> panner = audioCtx.createPannerNode();</span><br><span class="line">panner.setPosition(speaker.position.x, speaker.position.y, speaker.position.z); <span class="comment">// å°†å‘å£°ä½“åæ ‡ä¼ ç»™PannerNode</span></span><br><span class="line"></span><br><span class="line">source.connect(panner); <span class="comment">// å°†è¾“å…¥ç»“ç‚¹è¿æ¥åˆ°PannerNodeå¤„ç†ç»“ç‚¹</span></span><br><span class="line">panner.connect(audioCtx.destination); </span><br><span class="line">source.start(<span class="number">0</span>); <span class="comment">// æ’­æ”¾éŸ³é¢‘</span></span><br></pre></td></tr></table></figure>
<h2 id="è®¾ç½®AudioListener"><a href="#è®¾ç½®AudioListener" class="headerlink" title="è®¾ç½®AudioListener"></a>è®¾ç½®AudioListener</h2><p>æˆ‘ä»¬éœ€è¦å°†è¿™3dç©å®¶è§’è‰²çš„ä½ç½®ä¿¡æ¯ä¼ å…¥AudioListenerï¼Œç”±å®ƒä¸ºæˆ‘ä»¬å¤„ç†éŸ³é¢‘æ•°æ®ã€‚<br>å¯¹äºç”¨æˆ·ä½ç½®æ•°æ®ï¼ŒAudioListeneræä¾›äº†ä¸‰ä¸ªä½ç½®å±æ€§ï¼š<code>positionX</code>,<code>positionY</code>,<code>positionZ</code>ï¼Œå®ƒåˆ†åˆ«ä»£è¡¨å¬è€…å½“å‰ä½ç½®çš„xyzåæ ‡ï¼Œæˆ‘ä»¬å¯å°†ç”¨æˆ·åœ¨åœºæ™¯ä¸­çš„ä½ç½®ï¼ˆä¸€èˆ¬ç”¨cameraçš„positionï¼‰èµ‹å€¼ç»™è¿™ä¸‰ä¸ªå±æ€§ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¸ºlistenerè®¾ç½®position</span></span><br><span class="line"><span class="keyword">const</span> listener = audioCtx.listener;</span><br><span class="line">listener.positionX = camera.position.x;</span><br><span class="line">listener.positionY = camera.position.y;</span><br><span class="line">listener.positionZ = camera.position.z;</span><br></pre></td></tr></table></figure>
<p>é™¤äº†ä¼ å…¥ç”¨æˆ·çš„ä½ç½®ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å°†ç”¨æˆ·çš„è§†è§’æ–¹å‘ä¿¡æ¯ä¼ ç»™<code>AudioListener</code>ï¼Œå…·ä½“æ˜¯ç»™AudioListenerçš„Forwardå‘é‡ä¸‰ä¸ªåˆ†é‡<code>forwardX</code>,<code>forwardY</code>,<code>forwardZ</code>å’ŒUpå‘é‡ä¸‰ä¸ªåˆ†é‡<code>upX</code>,<code>upY</code>,<code>upZ</code>èµ‹å€¼ã€‚</p>
<ul>
<li>Forwardå‘é‡æ²¿ç€é¼»å­æ–¹å‘æŒ‡å‘å‰ï¼Œé»˜è®¤æ˜¯(0,0,-1)ï¼›</li>
<li>Upå‘é‡æ²¿ç€å¤´é¡¶æ–¹å‘æŒ‡å‘ä¸Šï¼Œé»˜è®¤æ˜¯(0,1,0)ã€‚<br><img src="http://upload-images.jianshu.io/upload_images/1939855-a2e551ff0d5b4bb6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Forwardå‘é‡ä¸Upå‘é‡"></li>
<li>å½“ç”¨æˆ·è§’è‰²æ”¹å˜è§†è§’æ—¶ï¼Œupå‘é‡æˆ–forwardå‘é‡ä¼šéšä¹‹æ”¹å˜ï¼Œä½†ä¸¤è€…å§‹ç»ˆå‚ç›´ã€‚<blockquote>
<p>Upå‘é‡ = Camera.æ—‹è½¬çŸ©é˜µ Ã— [0,1,0]<br>Forwardå‘é‡ = Camera.æ—‹è½¬çŸ©é˜µ Ã— [0,0,-1]</p>
</blockquote>
</li>
</ul>
<p>å‚ç…§ä¸Šæ–¹å…¬å¼ï¼Œè¿™é‡Œçš„cameraæ˜¯three.jsçš„cameraï¼ŒæŒ‡ä»£ç”¨æˆ·çš„å¤´éƒ¨ï¼Œé€šè¿‡<code>camera.quaternion</code>è·å–ç›¸æœºçš„æ—‹è½¬ï¼ˆå››å…ƒæ•°ï¼‰çŸ©é˜µï¼Œä¸åˆå§‹å‘é‡ç›¸ä¹˜ï¼Œå¾—åˆ°å½“å‰Upå‘é‡å’ŒForwardå‘é‡ï¼Œä»£ç å¦‚ä¸‹ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è®¡ç®—å½“å‰listenerçš„forwardå‘é‡</span></span><br><span class="line"><span class="keyword">let</span> forward = <span class="keyword">new</span> THREE.Vector3(<span class="number">0</span>,<span class="number">0</span>,<span class="number">-1</span>);</span><br><span class="line">forward.applyQuaternion(camera.quaternion); <span class="comment">// forwardåˆå§‹å‘é‡ä¸cameraå››å…ƒæ•°çŸ©é˜µç›¸ä¹˜ï¼Œå¾—åˆ°å½“å‰çš„forwardå‘é‡</span></span><br><span class="line">forward.normalize(); <span class="comment">// å‘é‡å½’ä¸€</span></span><br><span class="line"><span class="comment">// èµ‹å€¼ç»™AudioListenerçš„forwardåˆ†é‡</span></span><br><span class="line">listener.forwardX.value = forward.x;</span><br><span class="line">listener.forwardY.value = forward.y;</span><br><span class="line">listener.forwardZ.value = forward.z;</span><br><span class="line"><span class="comment">// è®¡ç®—å½“å‰listenerçš„upå‘é‡</span></span><br><span class="line"><span class="keyword">let</span> up = <span class="keyword">new</span> THREE.Vector3(<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line">up.applyQuaternion(camera.quaternion); <span class="comment">// upåˆå§‹å‘é‡ä¸cameraå››å…ƒæ•°çŸ©é˜µç›¸ä¹˜ï¼Œå¾—åˆ°å½“å‰çš„upå‘é‡</span></span><br><span class="line">up.normalize(); <span class="comment">// å‘é‡å½’ä¸€</span></span><br><span class="line"><span class="comment">// èµ‹å€¼ç»™AudioListenerçš„upåˆ†é‡</span></span><br><span class="line">listener.upX.value = up.x;</span><br><span class="line">listener.upY.value = up.y;</span><br><span class="line">listener.upZ.value = up.z;</span><br></pre></td></tr></table></figure></p>
<hr>
<h1 id="å®ç°éŸ³é¢‘è§’è‰²"><a href="#å®ç°éŸ³é¢‘è§’è‰²" class="headerlink" title="å®ç°éŸ³é¢‘è§’è‰²"></a>å®ç°éŸ³é¢‘è§’è‰²</h1><p>åœ¨3dåœºæ™¯ä¸­ï¼Œæ ¹æ®éŸ³é¢‘çš„å‘èµ·æ–¹å’Œæ¥æ”¶æ–¹å¯ä»¥åˆ†ä¸ºä¸¤ä¸ªè§’è‰²ï¼šSpeakerå‘å£°ä½“ä¸Listenerå¬è€…ï¼Œå³ç”¨æˆ·ã€‚<br><img src="http://upload-images.jianshu.io/upload_images/1939855-a0b7fe84246097c3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Listener-Speakerçš„ä¸€å¯¹å¤šå…³ç³»"><br>ä¸€ä¸ª3dåœºæ™¯éŸ³é¢‘è§’è‰²ç”±ä¸€ä¸ªListenerå’Œå¤šä¸ªSpeakerç»„æˆï¼Œäºæ˜¯ç¬”è€…å°†<code>PannerNode</code>å’Œ<code>AudioListener</code>è¿›è¡Œç‹¬ç«‹å°è£…ï¼Œæ•´åˆä¸ºSpeakerç±»å’ŒListenerå¯¹è±¡ã€‚<br><em>PSï¼šè¿™é‡Œæ²¿ç”¨å‰å‡ æœŸthree.jså¼€å‘WebVRçš„æ–¹å¼ï¼Œå¯å‚è€ƒ<a href="https://zhuanlan.zhihu.com/p/25567905" target="_blank" rel="noopener">ã€ŠWebVRå¼€å‘â€”â€”æ ‡å‡†æ•™ç¨‹ã€‹</a></em></p>
<h2 id="Speakerå®ç°"><a href="#Speakerå®ç°" class="headerlink" title="Speakerå®ç°"></a>Speakerå®ç°</h2><p>Speakerç±»ä»£è¡¨å‘å£°ä½“ï¼Œä¸»è¦åšäº†ä»¥ä¸‹äº‹æƒ…ï¼š</p>
<ol>
<li>åˆå§‹åŒ–é˜¶æ®µåŠ è½½è§£æéŸ³é¢‘æºï¼Œåˆ›å»ºå¹¶è¿æ¥è¾“å…¥ç»“ç‚¹ã€å¤„ç†ç»“ç‚¹ã€è¾“å‡ºç»“ç‚¹</li>
<li>æä¾›<code>update</code>å…¬ç”¨æ–¹æ³•ï¼Œåœ¨æ¯ä¸€å¸§ä¸­æ›´æ–°PannerNodeä½ç½®ã€‚<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Speaker</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(ctx,path) &#123;</span><br><span class="line">        <span class="keyword">this</span>.path = path;</span><br><span class="line">        <span class="keyword">this</span>.ctx = ctx;</span><br><span class="line">        <span class="keyword">this</span>.source = ctx.createBufferSource();</span><br><span class="line">        <span class="keyword">this</span>.panner = ctx.createPanner();</span><br><span class="line">        <span class="keyword">this</span>.source.loop = <span class="literal">true</span>; <span class="comment">// è®¾ç½®éŸ³é¢‘å¾ªç¯æ’­æ”¾</span></span><br><span class="line">        <span class="keyword">this</span>.source.connect(<span class="keyword">this</span>.panner); <span class="comment">// å°†è¾“å…¥ç»“ç‚¹è¿è‡³PannerNode</span></span><br><span class="line">        <span class="keyword">this</span>.panner.connect(ctx.destination); <span class="comment">// å°†PannerNodeè¿è‡³è¾“å‡ºç»“ç‚¹</span></span><br><span class="line">        <span class="keyword">this</span>._processAudio(); <span class="comment">// å¼‚æ­¥å‡½æ•°ï¼Œè¯·æ±‚ä¸åŠ è½½éŸ³é¢‘æ•°æ®</span></span><br><span class="line">    &#125;</span><br><span class="line">    update(position) &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123; panner &#125; = <span class="keyword">this</span>;</span><br><span class="line">        panner.setPosition(position.x, position.y, position.z); <span class="comment">// å°†å‘å£°ä½“åæ ‡ä¼ ç»™PannerNode</span></span><br><span class="line">    &#125;</span><br><span class="line">    _loadAudio(path) &#123; </span><br><span class="line">        <span class="comment">// ä½¿ç”¨fetchè¯·æ±‚éŸ³é¢‘æ–‡ä»¶</span></span><br><span class="line">        <span class="keyword">return</span> fetch(path).then(<span class="function"><span class="params">res</span> =&gt;</span> res.arrayBuffer());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">async</span> _processAudio() &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123; path, ctx, source &#125; = <span class="keyword">this</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> data = <span class="keyword">await</span> <span class="keyword">this</span>._loadAudio(path); <span class="comment">// å¼‚æ­¥è¯·æ±‚éŸ³é¢‘</span></span><br><span class="line">            <span class="keyword">const</span> buffer = <span class="keyword">await</span> ctx.decodeAudioData(data); <span class="comment">// è§£ç éŸ³é¢‘æ•°æ®</span></span><br><span class="line">            source.buffer = buffer; <span class="comment">// å°†è§£ç æ•°æ®èµ‹å€¼ç»™BufferSourceNodeè¾“å…¥ç»“ç‚¹</span></span><br><span class="line">            source.start(<span class="number">0</span>); <span class="comment">// æ’­æ”¾éŸ³é¢‘</span></span><br><span class="line">        &#125; <span class="keyword">catch</span>(err) &#123;</span><br><span class="line">            <span class="built_in">console</span>.err(err);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>è¿™é‡Œåˆå§‹åŒ–çš„æµç¨‹è·Ÿå‰é¢ç•¥æœ‰ä¸åŒï¼Œè¿™é‡Œä½¿ç”¨çš„æ˜¯fetchè¯·æ±‚éŸ³é¢‘æ–‡ä»¶ï¼Œé€šè¿‡<code>BufferSourceNode</code>è¾“å…¥ç»“ç‚¹è§£æéŸ³é¢‘æ•°æ®ã€‚<br><code>update</code>æ–¹æ³•ä¼ å…¥å‘å£°ä½“positionï¼Œè®¾ç½®<code>PannerNode</code>ä½ç½®ã€‚</p>
<h2 id="Listenerå®ç°"><a href="#Listenerå®ç°" class="headerlink" title="Listenerå®ç°"></a>Listenerå®ç°</h2><p>Listenerå¯¹è±¡ä»£è¡¨å¬è€…ï¼Œæä¾›<code>update</code>å…¬ç”¨æ–¹æ³•ï¼Œåœ¨æ¯å¸§ä¸­ä¼ å…¥<code>AudioListener</code>çš„ä½ç½®å’Œæ–¹å‘ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åˆ›å»ºListenerå¯¹è±¡</span></span><br><span class="line"><span class="keyword">const</span> Listener = &#123;</span><br><span class="line">  init(ctx) &#123;</span><br><span class="line">    <span class="keyword">this</span>.ctx = ctx;</span><br><span class="line">    <span class="keyword">this</span>.listener = <span class="keyword">this</span>.ctx.listener;</span><br><span class="line">  &#125;,</span><br><span class="line">  update(position,quaternion) &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; listener &#125; = <span class="keyword">this</span>;</span><br><span class="line">    listener.positionX = position.x;</span><br><span class="line">    listener.positionY = position.y;</span><br><span class="line">    listener.positionZ = position.z;</span><br><span class="line">    <span class="comment">// è®¡ç®—å½“å‰listenerçš„forwardå‘é‡</span></span><br><span class="line">    <span class="keyword">let</span> forward = <span class="keyword">new</span> THREE.Vector3(<span class="number">0</span>,<span class="number">0</span>,<span class="number">-1</span>);</span><br><span class="line">    forward.applyQuaternion(quaternion);</span><br><span class="line">    forward.normalize();</span><br><span class="line">    listener.forwardX.value = forward.x;</span><br><span class="line">    listener.forwardY.value = forward.y;</span><br><span class="line">    listener.forwardZ.value = forward.z;</span><br><span class="line">    <span class="comment">// è®¡ç®—å½“å‰listenerçš„upå‘é‡</span></span><br><span class="line">    <span class="keyword">let</span> up = <span class="keyword">new</span> THREE.Vector3(<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line">    up.applyQuaternion(quaternion);</span><br><span class="line">    up.normalize();</span><br><span class="line">    listener.upX.value = up.x;</span><br><span class="line">    listener.upY.value = up.y;</span><br><span class="line">    listener.upZ.value = up.z;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>è¿™é‡Œåªæ˜¯ç®€å•çš„å°†<code>AudioListener</code>ä½œä¸€å±‚å°è£…ï¼Œupdateæ–¹æ³•ä¼ å…¥cameraçš„positionå’Œå››å…ƒæ•°çŸ©é˜µï¼Œè®¾ç½®<code>AudioListener</code>ä½ç½®ã€æ–¹å‘ã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œå°†Listenerå’ŒSpeakerå¼•å…¥åˆ°WebVRåº”ç”¨ä¸­ï¼Œä¸‹é¢ä¾‹å­æè¿°äº†è¿™æ ·ä¸€ä¸ªç®€é™‹åœºæ™¯ï¼šä¸€è¾†ç‹‚å“å–‡å­çš„æ±½è½¦ä»ä½ èº«æ—ç»è¿‡ï¼Œå¹¶é©¶å‘è¿œæ–¹ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WebVRApp</span> </span>&#123;</span><br><span class="line">...</span><br><span class="line">  start() &#123;</span><br><span class="line">      <span class="keyword">const</span> &#123; scene, camera &#125; = <span class="keyword">this</span>;</span><br><span class="line">      ... <span class="comment">// åˆ›å»ºç¯å…‰ã€åœ°é¢</span></span><br><span class="line">      <span class="comment">// åˆ›å»ºä¸€è¾†ç®€é™‹å°è½¦</span></span><br><span class="line">      <span class="keyword">const</span> geometry = <span class="keyword">new</span> THREE.CubeGeometry(<span class="number">4</span>, <span class="number">3</span>, <span class="number">5</span>);</span><br><span class="line">      <span class="keyword">const</span> material = <span class="keyword">new</span> THREE.MeshLambertMaterial(&#123; <span class="attr">color</span>: <span class="number">0xef6500</span> &#125;);</span><br><span class="line">      <span class="keyword">this</span>.car = <span class="keyword">new</span> THREE.Mesh(geometry, material)ï¼›</span><br><span class="line">      <span class="keyword">this</span>.car.position.set(<span class="number">-12</span>, <span class="number">2</span>, <span class="number">-100</span>);</span><br><span class="line">      scene.add(<span class="keyword">this</span>.car);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">const</span> ctx = <span class="keyword">new</span> AudioContext(); <span class="comment">// åˆ›å»ºAudioContextä¸Šä¸‹æ–‡</span></span><br><span class="line">      Listener.init(ctx); <span class="comment">// åˆå§‹åŒ–listener</span></span><br><span class="line">      <span class="keyword">this</span>.car_speaker = <span class="keyword">new</span> Speaker(ctx,<span class="string">'audio/horn.wav'</span>); <span class="comment">// åˆ›å»ºspeakerï¼Œä¼ å…¥ä¸Šä¸‹æ–‡å’ŒéŸ³é¢‘è·¯å¾„</span></span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>é¦–å…ˆåœ¨<code>start</code>æ–¹æ³•åˆ›å»ºå°æ±½è½¦ï¼Œæ¥ç€åˆå§‹åŒ–Listenerå¹¶åˆ›å»ºä¸€ä¸ªSpeakerã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Web3dApp</span> </span>&#123;</span><br><span class="line">...</span><br><span class="line">  update() &#123;</span><br><span class="line">      <span class="keyword">const</span> &#123; scene, camera, renderer&#125; = <span class="keyword">this</span>;</span><br><span class="line">      <span class="comment">// å¯åŠ¨æ¸²æŸ“</span></span><br><span class="line">      <span class="keyword">this</span>.car.position.z += <span class="number">0.4</span>;</span><br><span class="line">      <span class="keyword">this</span>.car_speaker.update(<span class="keyword">this</span>.car.position); <span class="comment">// æ›´æ–°speakerä½ç½®</span></span><br><span class="line">      Listener.update(camera.position, camera.quaternion); <span class="comment">// æ›´æ–°Listenerä½ç½®ä»¥åŠå¤´éƒ¨æœå‘</span></span><br><span class="line">      renderer.render(scene, camera);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">new</span> Web3dApp();</span><br></pre></td></tr></table></figure></p>
<p>åœ¨åŠ¨ç”»æ¸²æŸ“<code>update</code>æ–¹æ³•ä¸­ï¼Œæ›´æ–°å°æ±½è½¦çš„ä½ç½®ï¼Œå¹¶è°ƒç”¨Speakerå’ŒListenerçš„updateæ–¹æ³•ï¼Œä¼ å…¥å°æ±½è½¦çš„ä½ç½®ã€ç”¨æˆ·çš„ä½ç½®å’Œæ—‹è½¬çŸ©é˜µï¼Œæ›´æ–°éŸ³é¢‘ç©ºé—´ä¿¡æ¯ã€‚<br>ç¤ºä¾‹åœ°å€ï¼š<em><a href="https://yonechen.github.io/WebVR-helloworld/3d-audio.htmlï¼ˆéœ€è¦æ”¯æŒes7çš„æµè§ˆå™¨å¦‚æ–°ç‰ˆchromeï¼Œå¤ªæ‡’æ²¡åšæ‰“åŒ…ç¼–è¯‘ğŸ˜†ï¼‰" target="_blank" rel="noopener">https://yonechen.github.io/WebVR-helloworld/3d-audio.htmlï¼ˆéœ€è¦æ”¯æŒes7çš„æµè§ˆå™¨å¦‚æ–°ç‰ˆchromeï¼Œå¤ªæ‡’æ²¡åšæ‰“åŒ…ç¼–è¯‘ğŸ˜†ï¼‰</a></em><br>æºç åœ°å€ï¼š<em><a href="https://github.com/YoneChen/WebVR-helloworld/blob/master/3d-audio.html" target="_blank" rel="noopener">https://github.com/YoneChen/WebVR-helloworld/blob/master/3d-audio.html</a></em></p>
<h1 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h1><p>æœ¬æ–‡ä¸»è¦è®²è§£äº†Web3dåº”ç”¨éŸ³é¢‘ç©ºé—´åŒ–çš„å®ç°æ­¥éª¤ï¼Œæ ¸å¿ƒæ˜¯è¿ç”¨äº†Web Audio APIçš„<code>PannerNode</code>å’Œ<code>AudioListener</code>ä¸¤ä¸ªå¯¹è±¡å¤„ç†éŸ³é¢‘æºï¼Œæ–‡æœ«å±•ç¤ºäº†3d Audioçš„ä¸€ä¸ªç®€å•ä»£ç ä¾‹å­ï¼Œthree.jsæœ¬èº«ä¹Ÿæä¾›äº†å®Œå–„çš„éŸ³é¢‘ç©ºé—´åŒ–æ”¯æŒï¼Œå¯ä»¥å‚è€ƒ<a href="https://threejs.org/docs/api/audio/PositionalAudio.html" target="_blank" rel="noopener">PositinalAudio</a>ã€‚<br>æ›´å¤šæ–‡ç« å¯å…³æ³¨<a href="https://zhuanlan.zhihu.com/c_99472965" target="_blank" rel="noopener">WebXRæŠ€æœ¯åº„å›­</a><br><a href="http://www.jianshu.com/p/997d354d5663" target="_blank" rel="noopener">WebVRå¼€å‘æ•™ç¨‹â€”â€”äº¤äº’äº‹ä»¶ï¼ˆäºŒï¼‰ä½¿ç”¨Gamepad</a><br><a href="https://zhuanlan.zhihu.com/p/28324884" target="_blank" rel="noopener">WebVRå¼€å‘æ•™ç¨‹â€”â€”æ·±åº¦å‰–æ</a> å…³äºWebVRçš„å¼€å‘è°ƒè¯•æ–¹æ¡ˆä»¥åŠåŸç†æœºåˆ¶<br><a href="https://zhuanlan.zhihu.com/p/25567905" target="_blank" rel="noopener">WebVRå¼€å‘æ•™ç¨‹â€”â€”æ ‡å‡†å…¥é—¨</a> ä½¿ç”¨Three.jså¼€å‘WebVRåœºæ™¯çš„å…¥é—¨æ•™ç¨‹</p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/webAudio/" rel="tag"># webAudio</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/06/11/python-project/" rel="next" title="å†™ç»™å‰ç«¯çš„Pythonä¾èµ–ç®¡ç†æŒ‡åŒ—">
                <i class="fa fa-chevron-left"></i> å†™ç»™å‰ç«¯çš„Pythonä¾èµ–ç®¡ç†æŒ‡åŒ—
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/06/11/webgl-noise/" rel="prev" title="WebGLè¿›é˜¶â€”â€”èµ°è¿›å›¾å½¢å™ªå£°">
                WebGLè¿›é˜¶â€”â€”èµ°è¿›å›¾å½¢å™ªå£° <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            æ–‡ç« ç›®å½•
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            ç«™ç‚¹æ¦‚è§ˆ
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          
            <p class="site-author-name" itemprop="name">Yone Chen</p>
            <p class="site-description motion-element" itemprop="description">æŠ€æœ¯ç©ºé—´ç«™</p>
        </div>

        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
            
              <a href="/archives/">
            
                <span class="site-state-item-count">9</span>
                <span class="site-state-item-name">æ—¥å¿—</span>
              </a>
            </div>
          

          

          
            
            
            <div class="site-state-item site-state-tags">
              
                <span class="site-state-item-count">5</span>
                <span class="site-state-item-name">æ ‡ç­¾</span>
              
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#3D-Audio"><span class="nav-number">1.</span> <span class="nav-text">3D Audio</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#é™æ€éŸ³é¢‘"><span class="nav-number">1.1.</span> <span class="nav-text">é™æ€éŸ³é¢‘</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ç©ºé—´åŒ–éŸ³é¢‘"><span class="nav-number">1.2.</span> <span class="nav-text">ç©ºé—´åŒ–éŸ³é¢‘</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Web-Audio-API-ç®€ä»‹"><span class="nav-number">2.</span> <span class="nav-text">Web Audio API ç®€ä»‹</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#AudioContext"><span class="nav-number">2.1.</span> <span class="nav-text">AudioContext</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#AudioNode"><span class="nav-number">2.2.</span> <span class="nav-text">AudioNode</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#å®ç°ç©ºé—´åŒ–éŸ³é¢‘"><span class="nav-number">3.</span> <span class="nav-text">å®ç°ç©ºé—´åŒ–éŸ³é¢‘</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#è®¾ç½®PannerNode"><span class="nav-number">3.1.</span> <span class="nav-text">è®¾ç½®PannerNode</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#è®¾ç½®AudioListener"><span class="nav-number">3.2.</span> <span class="nav-text">è®¾ç½®AudioListener</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#å®ç°éŸ³é¢‘è§’è‰²"><span class="nav-number">4.</span> <span class="nav-text">å®ç°éŸ³é¢‘è§’è‰²</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Speakerå®ç°"><span class="nav-number">4.1.</span> <span class="nav-text">Speakerå®ç°</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Listenerå®ç°"><span class="nav-number">4.2.</span> <span class="nav-text">Listenerå®ç°</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#å°ç»“"><span class="nav-number">5.</span> <span class="nav-text">å°ç»“</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Yone Chen</span> |
  <a link="https://beian.miit.gov.cn/">ç²¤ICPå¤‡17126485å·</a>

  
</div>


  <div class="powered-by">ç”± <a class="theme-link" href="https://hexo.io">Hexo</a> å¼ºåŠ›é©±åŠ¨</div>

  <span class="post-meta-divider">|</span>
  <div class="theme-info">ä¸»é¢˜ &mdash; <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.2</div>


        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.2"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.2"></script>



  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.2"></script>


  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.2"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.2"></script>



  


  




	





  





  








  





  

  

  

  

  

  

</body>
</html>
